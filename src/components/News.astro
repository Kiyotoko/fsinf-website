---
import { getCollection } from "astro:content";
import FormattedDate from "./FormattedDate.astro";

const news = await getCollection("news");

// Sort news after date and then limit them to 3. We don't want to show more then
// the last 3 most recent posts on the front page.
const sortedNews = news
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<div
  class="grid w-full grid-cols-1 justify-center gap-4 sm:grid-cols-2 lg:grid-cols-3"
>
  {
    sortedNews.map((item) => (
      <div class="border-sm flex h-auto w-full flex-col rounded-3xl border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800">
        <a href={`/news/${item.slug}/`}>
          <img
            class="h-48 w-full rounded-t-lg object-cover"
            src={item.data.heroImage}
            alt={item.data.title}
          />
        </a>
        <div class="flex flex-grow flex-col justify-between p-4 text-center">
          <a href={`/news/${item.slug}/`}>
            <h5 class="mb-2 text-lg font-bold tracking-tight text-gray-900 dark:text-white">
              {item.data.title}
            </h5>
          </a>
          <p class="mb-2 text-xs font-bold text-gray-400 dark:text-gray-300">
            <FormattedDate date={item.data.pubDate} />
          </p>
          <p class="mb-4 text-base font-normal text-gray-700 dark:text-gray-100">
            {item.data.description}
          </p>
          <div class="mt-auto flex justify-center">
            <a
              href={`/news/${item.slug}/`}
              class="rounded-lg bg-blue-500 px-3 py-1 text-center text-sm text-white hover:text-gray-300 focus:text-gray-400 focus:outline-none focus:ring-4 focus:ring-gray-300 dark:bg-blue-600 dark:text-gray-100 hover:dark:text-gray-400 dark:hover:ring-gray-400 focus:dark:text-gray-400"
            >
              weiterlesen
            </a>
          </div>
        </div>
      </div>
    ))
  }
</div>
